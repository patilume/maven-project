pipeline {
	//make sure docker is installed on jenkins machine and docker service is active
	agent { label 'docker-agent' }

	stages{
		stage('set enviornment'){
			steps{
				script {
					env.username = 'Umesh Patil'
					env.email = 'patilume@gmail.com'
					env.dockerImageName = 'my-webapp'
					env.dockerImageVersion = '1.2.0'
				}
			}
		}
		
		stage('Git Checkout'){
			steps{
				git url: 'https://github.com/patilume/maven-project.git',
				branch:'master'
			}
		}

		stage('MVN Package'){
			agent { 
				docker {
					image 'maven:3-jdk-8' 
					label 'docker-agent'
				} 
			}
			//agent { docker { image 'maven:3-alpine' } }
			steps{
				//def mvnHome = tool name: 'maven', type: 'maven'
				//sh "${mvnHome}/bin/mvn clean package"
				//sh 'mvn clean package'
				sh 'mvn --version'
			}
		}	
	}
}
